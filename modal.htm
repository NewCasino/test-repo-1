<!-- modal window container -->
<div id="modal" class="modalwindow">
    <div class="modal-title">
		<span id="modal-title"></span>
		<span class="modal-close"><a href="#">X</a></span>
	</div>
    <div id="modal-content" class="modal-content">
    </div>
</div>

<!-- edit runner template -->
<script type="text/html" id="edit_runner_tpl">
<table cellpadding="5">
	<tr><td width="150px">Meeting Id</td><td>{{meeting_id}}</td></tr>
	<tr><td>Race Number</td><td>{{race_num}}</td></tr>
	<tr><td>Runner Number</td><td>{{runner_num}}</td></tr>
	<tr><td>Tab Prop Id</td><td><input id="tab-prop" type="text" value="{{tab_prop}}" size="8" /></td></tr>
</table>
<hr class="hr" />
<input type="button" value="Save" class="modal-button modal-save" />
<input type="button" value="Cancel" class="modal-button modal-cancel" /> &nbsp;
</script>

<script>
var modalControl = {

	event_ref: '',
	
	openWindow: function(data) {
		var _this = this;
		this.event_ref = data.meeting_id+'_'+data.race_num;
		this.renderWindow(data);
		jQuery('.modalwindow .modal-close').click(function (event) {
			event.preventDefault();
			_this.closeWindow();
		});
		jQuery('.modalwindow .modal-button').click(function (event) {
			if (event.target.getAttribute('value') !== 'Save') {
				_this.closeWindow();
				return;
			}
			// 'save' clicked
			var tabProp = parseInt(jQuery('#tab-prop').val());
			if (isNaN(tabProp) || tabProp < 1) {
				_alert('Tab Prop Id must be greater than zero !!');
				return;
			}
			_confirm("Confirm you want to save the RUNNER data ??\n\nRunner: " + data.runner_num + ' - ' + data.runner,
				function(answerYes) {
					if (answerYes) {
						RunPropId(data.runner_num, tabProp);
					}
					_this.closeWindow();
				}
			);
		});
	},

	renderWindow: function(data) {
		var id = jQuery('#modal');
		document.getElementById('modal-title').innerHTML = 'Runner: '+data.runner_num+' - '+data.runner;
		var html = document.getElementById('edit_runner_tpl').innerHTML;
		html = html.replace(/{{meeting_id}}/,data.meeting_id)
				.replace(/{{race_num}}/,data.race_num)
				.replace(/{{runner_num}}/,data.runner_num)
				.replace(/{{tab_prop}}/,data.tab_prop);
		document.getElementById('modal-content').innerHTML = html;
		var winH = jQuery(window).height();
		var winW = jQuery(window).width();
		id.css('top', winH/2-id.height()/2);
		id.css('left', winW/2-id.width()/2);
		id.fadeIn(500);	
	},
	
	closeWindow: function() {
		jQuery('.modalwindow').fadeOut(500);
		tmrEVN = setTimeout("getEVN('" + this.event_ref + "')", 5000);	
	}
};
</script>

<style>
.modalwindow {
    position:fixed;
    display:none; /* Hides the modal window by default */
    z-index:9999;
    width:500px;
    background: #222;
    -webkit-box-shadow: 0 8px 6px -6px black;
    -moz-box-shadow: 0 8px 6px -6px black;
    box-shadow: 0 8px 6px -6px black;
    -webkit-box-shadow: 0 8px 6px -6px black;
    -moz-box-shadow: 0 8px 6px -6px black;
    box-shadow: 0 8px 6px -6px black;
}

.modal-title {
    background-color: #000;
    padding: 8px 15px;
    font-size: 15px;
    color: #fff;
    margin: 0;
    font-family: arial;
    text-align: left;
}

.modal-close a {
    color: #fff;
    float: right;
    margin-right: 10px;
    text-decoration: none;
    font-weight: bold;
}

.modal-content table  {
    padding: 10px;
    color: #fff;
    font-size: 1.2em;
}

.modal-content table input[type="text"] {
    color:crimson;
    font-weight: 900;
    padding-left: 5px;
}

.modal-button  {
	margin:10px 20px;
    padding: 6px 25px;
    background-color: #444;
	border: 0px solid #666;
    color: #fff;
    font-size: 1.2em;
	float: right;
	-moz-border-radius: 4px;
	-webkit-border-radius: 4px;
	border-radius: 4px; 
	-khtml-border-radius: 4px; 
}

.modal-save {
	background-color: darkgreen;
	cursor: pointer;
}

.modal-cancel {
	background-color: maroon;
	cursor: pointer;
}

.hr {
	padding: 0;
	margin: 0;
	border: 1px solid #666;
}
</style>